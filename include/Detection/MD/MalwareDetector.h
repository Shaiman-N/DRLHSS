#pragma once

#include <string>
#include <memory>
#include <vector>
#include <onnxruntime_cxx_api.h>

class MalwareDetector {
public:
    MalwareDetector(const std::string& modelPath);
    ~MalwareDetector();
    
    // Analyze file/data packet for malware
    bool detectMalware(const std::vector<uint8_t>& data, float& confidence);
    
    // Get model information
    std::string getModelInfo() const;
    
private:
    std::unique_ptr<Ort::Env> env_;
    std::unique_ptr<Ort::Session> session_;
    std::unique_ptr<Ort::SessionOptions> sessionOptions_;
    
    std::vector<const char*> inputNames_;
    std::vector<const char*> outputNames_;
    std::vector<int64_t> inputShape_;
    
    // Preprocess data for model input
    std::vector<float> preprocessData(const std::vector<uint8_t>& data);
};
