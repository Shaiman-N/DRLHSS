#pragma once

#include <string>
#include <memory>
#include <vector>
#include "MalwareProcessingPipeline.h"

class MalwareObject {
public:
    MalwareObject(std::shared_ptr<MalwareProcessingPipeline> pipeline);
    ~MalwareObject();
    
    // Scan a file through complete pipeline
    bool scanFile(const std::string& filePath);
    
    // Scan data packet through complete pipeline
    bool scanDataPacket(const std::vector<uint8_t>& packet);
    
    // Get scan results
    bool isMalwareDetected() const { return malwareDetected_; }
    bool isProcessingComplete() const { return processingComplete_; }
    std::string getFilePath() const { return currentFile_; }
    PipelineResult getPipelineResult() const { return pipelineResult_; }
    
    // Terminate this malware object
    void terminate();
    
private:
    std::shared_ptr<MalwareProcessingPipeline> pipeline_;
    bool malwareDetected_;
    bool processingComplete_;
    std::string currentFile_;
    bool terminated_;
    PipelineResult pipelineResult_;
};
